(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1166:(e,t,r)=>{"use strict";r.d(t,{$:()=>l});var a=r(5155);r(2115);var n=r(2821);let o={primary:{backgroundColor:"var(--accent)",color:"#0C0E14",border:"none"},secondary:{backgroundColor:"var(--bg-elevated)",color:"var(--text-primary)",border:"1px solid var(--border)"},ghost:{backgroundColor:"transparent",color:"var(--text-secondary)",border:"none"},danger:{backgroundColor:"var(--danger)",color:"#fff",border:"none"}},s={primary:{onEnter:e=>{let t=e.currentTarget;t.style.transform="translateY(-1px)",t.style.boxShadow="0 4px 16px var(--accent-glow)"},onLeave:e=>{let t=e.currentTarget;t.style.transform="translateY(0)",t.style.boxShadow="none"}},secondary:{onEnter:e=>{e.currentTarget.style.borderColor="var(--border-hover)"},onLeave:e=>{e.currentTarget.style.borderColor="var(--border)"}},ghost:{onEnter:e=>{e.currentTarget.style.backgroundColor="var(--bg-secondary)"},onLeave:e=>{e.currentTarget.style.backgroundColor="transparent"}},danger:{onEnter:e=>{let t=e.currentTarget;t.style.transform="translateY(-1px)",t.style.opacity="0.9"},onLeave:e=>{let t=e.currentTarget;t.style.transform="translateY(0)",t.style.opacity="1"}}};function l(e){let{variant:t="primary",size:r="md",isLoading:l,children:i,className:c,disabled:d,onMouseEnter:m,onMouseLeave:u,...x}=e;return(0,a.jsxs)("button",{disabled:d||l,className:(0,n.$)("inline-flex items-center justify-center font-sans font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",{"text-xs px-3 py-1.5 gap-1":"sm"===r,"text-sm px-4 py-2 gap-2":"md"===r,"text-base px-6 py-3 gap-2":"lg"===r},c),style:{borderRadius:"var(--radius-md)",transition:"all 0.2s cubic-bezier(0.16, 1, 0.3, 1)",...o[t]},onMouseEnter:e=>{var r;null==(r=s[t])||r.onEnter(e),null==m||m(e)},onMouseLeave:e=>{var r;null==(r=s[t])||r.onLeave(e),null==u||u(e)},...x,children:[l&&(0,a.jsxs)("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),i]})}},2234:(e,t,r)=>{Promise.resolve().then(r.bind(r,2595))},2595:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>eN});var a=r(5155),n=r(2115);let o=[{id:"riyadh",nameEn:"Riyadh",nameAr:"الرياض",lat:24.7136,lon:46.6753,region:"Central",avgDNI:5.8},{id:"jeddah",nameEn:"Jeddah",nameAr:"جدة",lat:21.4858,lon:39.1925,region:"Western",avgDNI:5.5},{id:"makkah",nameEn:"Makkah",nameAr:"مكة المكرمة",lat:21.3891,lon:39.8579,region:"Western",avgDNI:5.6},{id:"madinah",nameEn:"Madinah",nameAr:"المدينة المنورة",lat:24.5247,lon:39.5692,region:"Western",avgDNI:5.7},{id:"dammam",nameEn:"Dammam",nameAr:"الدمام",lat:26.4207,lon:50.0888,region:"Eastern",avgDNI:5.4},{id:"khobar",nameEn:"Al-Khobar",nameAr:"الخبر",lat:26.2172,lon:50.1971,region:"Eastern",avgDNI:5.4},{id:"dhahran",nameEn:"Dhahran",nameAr:"الظهران",lat:26.2361,lon:50.0393,region:"Eastern",avgDNI:5.5},{id:"taif",nameEn:"Taif",nameAr:"الطائف",lat:21.2854,lon:40.4158,region:"Western",avgDNI:5.9},{id:"tabuk",nameEn:"Tabuk",nameAr:"تبوك",lat:28.3838,lon:36.555,region:"Northern",avgDNI:6},{id:"abha",nameEn:"Abha",nameAr:"أبها",lat:18.2164,lon:42.5053,region:"Southern",avgDNI:5.2},{id:"jizan",nameEn:"Jizan",nameAr:"جيزان",lat:16.8892,lon:42.5511,region:"Southern",avgDNI:5.1},{id:"najran",nameEn:"Najran",nameAr:"نجران",lat:17.4923,lon:44.1277,region:"Southern",avgDNI:5.7},{id:"hail",nameEn:"Hail",nameAr:"حائل",lat:27.5114,lon:41.6931,region:"Northern",avgDNI:5.9},{id:"buraidah",nameEn:"Buraidah",nameAr:"بريدة",lat:26.326,lon:43.975,region:"Central",avgDNI:5.8},{id:"jubail",nameEn:"Al Jubail",nameAr:"الجبيل",lat:27.0174,lon:49.658,region:"Eastern",avgDNI:5.4},{id:"yanbu",nameEn:"Yanbu",nameAr:"ينبع",lat:24.0899,lon:38.0618,region:"Western",avgDNI:5.5}],s=o.find(e=>"riyadh"===e.id),l={tariff:{tier1MaxKwhPerMonth:6e3,tier1RateSarPerKwh:.18,tier2RateSarPerKwh:.3,source:"Saudi Electricity Company (SEC) residential tariff, effective Jan 2018. https://www.se.com.sa/en-us/customers/pages/tariff.aspx",lastVerified:"2024-11",note:"Commercial rates differ slightly; this tool defaults to residential. Custom rate input overrides all tiers."},pvSystem:{defaultWPerM2:216,defaultPackingFactor:1,defaultSystemLossPercent:14,defaultInverterEffPercent:96,defaultDegradationPctPerYear:.5,source:'Fraunhofer ISE 2012 "Photovoltaics Report" for degradation; PVGIS documentation for system loss default. https://joint-research-centre.ec.europa.eu/pvgis-photovoltaic-geographical-information-system_en'},selfConsumption:{conservativeLow:.35,conservativeHigh:.55,profileLow:.5,profileHigh:.7,source:"Adjusted for Saudi Arabia from Fraunhofer ISE 2015 baseline (20–40% for European residential). Saudi AC load peaks during solar production hours, raising self-consumption to 35–55% without batteries (GCC residential studies). Original: https://www.ise.fraunhofer.de/content/dam/ise/de/documents/publications/studies/recent-facts-about-photovoltaics-in-germany.pdf",rationale:"A range is shown instead of a single value because self-consumption is highly sensitive to occupancy patterns and appliance timing. Saudi defaults (35–55%) are higher than European values (20–40%) because heavy daytime AC load naturally coincides with solar production. Without 15-min smart-meter data, exact self-consumption cannot be determined."},economics:{defaultInstallCostSarPerKwp:3500,defaultOmCostSarPerKwpPerYear:50,discountRatePercent:5,projectLifeYears:25,gridCO2IntensityKgPerKwh:.57,source:"Install cost: REPDO Saudi Arabia 2023 market survey & Enerdata. CO2 factor: IEA 2022 Electricity CO2 Emissions Factors. Discount rate: Saudi bank market rates 2024."}},{tier1MaxKwhPerMonth:i,tier1RateSarPerKwh:c,tier2RateSarPerKwh:d}=l.tariff;function m(e){let t=Math.max(0,e),r=Math.min(t,i),a=Math.max(0,t-i),n=r*c+a*d;return{monthlyBill:Math.round(100*n)/100,annualBill:Math.round(12*n*100)/100,blendedRate:Math.round(1e4*(t>0?n/t:c))/1e4,tier1Kwh:r,tier2Kwh:a}}function u(e,t){return m(Math.max(0,e-t))}let x=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],p=[.65,.65,.75,.8,1,1.4,1.8,1.8,1.4,1,.8,.65],y=p.reduce((e,t)=>e+t,0),v=p.map(e=>e/y*12),h={city:s,roof:{usableAreaM2:100,tiltDeg:22,azimuthDeg:180,shadingLoss:5,useOptimalAngles:!1},consumption:{monthlyKwh:3e3,hasAC:!0,summerPeakMultiplier:1.8},advanced:{wPerM2:l.pvSystem.defaultWPerM2,packingFactor:l.pvSystem.defaultPackingFactor,systemLoss:l.pvSystem.defaultSystemLossPercent,inverterEff:l.pvSystem.defaultInverterEffPercent,degradationPct:l.pvSystem.defaultDegradationPctPerYear,projectLifeYears:l.economics.projectLifeYears,installCostPerKwp:l.economics.defaultInstallCostSarPerKwp,omCostPerKwpPerYear:l.economics.defaultOmCostSarPerKwpPerYear,selfConsumptionOverride:null},export:{enabled:!1,creditRatePerKwh:null,utilityProgram:""}};var g=r(1166);function f(e){let{value:t,onChange:r}=e,[s,l]=(0,n.useState)(""),[i,c]=(0,n.useState)(!1),d=s.length>0?o.filter(e=>e.nameEn.toLowerCase().includes(s.toLowerCase())||e.nameAr.includes(s)):null,m=d?{Results:d}:function(){let e={};for(let t of o)e[t.region]||(e[t.region]=[]),e[t.region].push(t);return e}(),u=["Central","Western","Eastern","Northern","Southern"],x=Object.keys(m).sort((e,t)=>u.indexOf(e)-u.indexOf(t));return(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"block text-sm font-medium",style:{color:"var(--text-primary)"},children:"City"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>c(!i),className:"w-full flex items-center justify-between rounded-lg px-3 py-2.5 text-sm text-left focus:outline-none focus:ring-2",style:{backgroundColor:"var(--bg-elevated)",border:"1px solid var(--border)",color:"var(--text-primary)","--tw-ring-color":"var(--accent)"},children:[(0,a.jsx)("span",{style:{color:t?"var(--text-primary)":"var(--text-tertiary)"},children:t?"".concat(t.nameEn," — ").concat(t.region):"Select a city…"}),(0,a.jsx)("svg",{className:"h-4 w-4 flex-shrink-0",style:{color:"var(--text-tertiary)"},fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),i&&(0,a.jsxs)("div",{className:"absolute z-50 mt-1 w-full",style:{backgroundColor:"var(--bg-elevated)",border:"1px solid var(--border)",boxShadow:"0 12px 40px rgba(0,0,0,0.2)",borderRadius:"var(--radius-md)"},children:[(0,a.jsx)("div",{className:"p-2",style:{borderBottom:"1px solid var(--border)"},children:(0,a.jsx)("input",{autoFocus:!0,type:"text",placeholder:"Search cities…",value:s,onChange:e=>l(e.target.value),className:"w-full px-3 py-1.5 text-sm rounded-md focus:outline-none focus:ring-2",style:{backgroundColor:"var(--bg-card)",border:"1px solid var(--border)",color:"var(--text-primary)","--tw-ring-color":"var(--accent)"}})}),(0,a.jsxs)("div",{className:"max-h-64 overflow-y-auto",children:[x.map(e=>(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"px-3 py-1.5 text-xs font-semibold uppercase tracking-wider",style:{backgroundColor:"var(--bg-secondary)",color:"var(--text-tertiary)",fontFamily:"var(--font-syne)"},children:e}),m[e].map(e=>(0,a.jsxs)("button",{type:"button",onClick:()=>{r(e),c(!1),l("")},className:"w-full flex items-center justify-between px-3 py-2 text-sm text-left transition-colors",style:{color:"var(--text-primary)"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="var(--accent-soft)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=""},children:[(0,a.jsx)("span",{style:{color:"var(--text-primary)"},children:e.nameEn}),(0,a.jsx)("span",{className:"text-xs",style:{color:"var(--text-tertiary)"},children:e.nameAr})]},e.id))]},e)),0===x.length&&(0,a.jsx)("p",{className:"px-3 py-4 text-sm text-center",style:{color:"var(--text-secondary)"},children:"No cities found"})]})]})]}),t&&(0,a.jsxs)("p",{className:"text-xs",style:{color:"var(--text-secondary)",fontFamily:"var(--font-ibm-plex-mono)"},children:["Coordinates: ",t.lat.toFixed(4),"\xb0N, ",t.lon.toFixed(4),"\xb0E \xb7 Avg DNI: ",t.avgDNI," kWh/m\xb2/day"]})]})}var b=r(2821);function j(e){let{label:t,hint:r,error:n,suffix:o,prefix:s,className:l,id:i,...c}=e,d=null!=i?i:null==t?void 0:t.toLowerCase().replace(/\s+/g,"-");return(0,a.jsxs)("div",{className:"space-y-1",children:[t&&(0,a.jsx)("label",{htmlFor:d,className:"block text-sm",style:{fontFamily:"var(--font-syne)",fontWeight:500,color:"var(--text-primary)"},children:t}),(0,a.jsxs)("div",{className:"relative flex items-center",children:[s&&(0,a.jsx)("span",{className:"absolute left-3 text-sm pointer-events-none",style:{color:"var(--text-tertiary)"},children:s}),(0,a.jsx)("input",{id:d,className:(0,b.$)("w-full text-sm","focus:outline-none focus:ring-2","disabled:cursor-not-allowed disabled:opacity-60",s?"pl-8 pr-4 py-2.5":"px-3 py-2.5",o?"pr-12":"",l),style:{backgroundColor:"var(--bg-elevated)",border:"1px solid ".concat(n?"var(--danger)":"var(--border)"),borderRadius:"var(--radius-sm)",color:"var(--text-primary)","--tw-ring-color":"var(--accent)",transition:"border-color 0.2s ease, box-shadow 0.2s ease"},onFocus:e=>{var t;e.currentTarget.style.borderColor="var(--accent)",null==(t=c.onFocus)||t.call(c,e)},onBlur:e=>{var t;e.currentTarget.style.borderColor=n?"var(--danger)":"var(--border)",null==(t=c.onBlur)||t.call(c,e)},...c}),o&&(0,a.jsx)("span",{className:"absolute right-3 text-sm pointer-events-none",style:{color:"var(--text-secondary)"},children:o})]}),r&&!n&&(0,a.jsx)("p",{className:"text-xs",style:{fontFamily:"var(--font-newsreader)",color:"var(--text-tertiary)"},children:r}),n&&(0,a.jsx)("p",{className:"text-xs",style:{color:"var(--danger)"},children:n})]})}let S=[{label:"None",value:0,description:"No shading on the roof"},{label:"Partial",value:5,description:"Some shading from trees or structures"},{label:"Heavy",value:15,description:"Significant shading, large obstructions"}],k=[{label:"South (best)",azimuth:180},{label:"South-East",azimuth:135},{label:"South-West",azimuth:225},{label:"East",azimuth:90},{label:"West",azimuth:270},{label:"North",azimuth:0}];function w(){return{backgroundColor:"var(--accent)",color:"#0C0E14"}}function C(){return{backgroundColor:"var(--bg-secondary)",color:"var(--text-secondary)"}}function N(e){let{value:t,onChange:r}=e,[o,s]=(0,n.useState)("direct"),[l,i]=(0,n.useState)(""),[c,d]=(0,n.useState)(""),[m,u]=(0,n.useState)(80);function x(){let e=parseFloat(l),t=parseFloat(c);isNaN(e)||isNaN(t)||r({usableAreaM2:Math.round(e*t*(m/100))})}return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>s("direct"),className:"flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-colors",style:"direct"===o?w():C(),onMouseEnter:e=>{"direct"!==o&&(e.currentTarget.style.backgroundColor="var(--bg-elevated)")},onMouseLeave:e=>{"direct"!==o&&(e.currentTarget.style.backgroundColor="var(--bg-secondary)")},children:"Enter area directly"}),(0,a.jsx)("button",{type:"button",onClick:()=>s("dimensions"),className:"flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-colors",style:"dimensions"===o?w():C(),onMouseEnter:e=>{"dimensions"!==o&&(e.currentTarget.style.backgroundColor="var(--bg-elevated)")},onMouseLeave:e=>{"dimensions"!==o&&(e.currentTarget.style.backgroundColor="var(--bg-secondary)")},children:"Enter length \xd7 width"})]}),"direct"===o?(0,a.jsx)(j,{label:"Usable rooftop area",type:"number",min:10,max:5e3,step:5,suffix:"m\xb2",value:t.usableAreaM2,onChange:e=>r({usableAreaM2:parseFloat(e.target.value)||0}),hint:"Usable = after excluding HVAC units, parapets, walkways, and shaded zones"}):(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsx)(j,{label:"Length",type:"number",min:1,step:.5,suffix:"m",value:l,onChange:e=>{i(e.target.value)},onBlur:x}),(0,a.jsx)(j,{label:"Width",type:"number",min:1,step:.5,suffix:"m",value:c,onChange:e=>{d(e.target.value)},onBlur:x})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium",style:{color:"var(--text-primary)"},children:["Usable portion: ",m,"%"]}),(0,a.jsx)("input",{type:"range",min:50,max:100,step:5,value:m,onChange:e=>{u(parseInt(e.target.value)),x()},className:"w-full",style:{accentColor:"var(--accent)"}}),(0,a.jsxs)("div",{className:"flex justify-between text-xs",style:{color:"var(--text-tertiary)"},children:[(0,a.jsx)("span",{children:"50% (many obstructions)"}),(0,a.jsx)("span",{children:"100% (clear roof)"})]})]}),t.usableAreaM2>0&&(0,a.jsxs)("p",{className:"text-sm rounded-lg px-3 py-2",style:{color:"var(--accent)",backgroundColor:"var(--accent-soft)",border:"1px solid var(--accent)"},children:["Usable area: ",(0,a.jsxs)("strong",{children:[t.usableAreaM2," m\xb2"]})]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium",style:{color:"var(--text-primary)"},children:["Roof orientation"," ",(0,a.jsx)("span",{className:"font-normal",style:{color:"var(--text-tertiary)"},children:"(optional)"})]}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-2",children:k.map(e=>{let n=t.azimuthDeg===e.azimuth&&!t.useOptimalAngles;return(0,a.jsx)("button",{type:"button",onClick:()=>r({azimuthDeg:e.azimuth,useOptimalAngles:!1}),className:"py-1.5 px-2 rounded-lg text-xs font-medium transition-colors",style:n?w():C(),onMouseEnter:e=>{n||(e.currentTarget.style.backgroundColor="var(--bg-elevated)")},onMouseLeave:e=>{n||(e.currentTarget.style.backgroundColor="var(--bg-secondary)")},children:e.label},e.azimuth)})}),(0,a.jsx)("button",{type:"button",onClick:()=>r({useOptimalAngles:!0}),className:"w-full py-1.5 px-3 rounded-lg text-xs font-medium transition-colors",style:t.useOptimalAngles?w():C(),onMouseEnter:e=>{t.useOptimalAngles||(e.currentTarget.style.backgroundColor="var(--bg-elevated)")},onMouseLeave:e=>{t.useOptimalAngles||(e.currentTarget.style.backgroundColor="var(--bg-secondary)")},children:"I don't know — use PVGIS optimal angles"})]}),!t.useOptimalAngles&&(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium",style:{color:"var(--text-primary)"},children:["Tilt angle: ",t.tiltDeg,"\xb0"]}),(0,a.jsx)("input",{type:"range",min:0,max:45,step:1,value:t.tiltDeg,onChange:e=>r({tiltDeg:parseInt(e.target.value)}),className:"w-full",style:{accentColor:"var(--accent)"}}),(0,a.jsxs)("div",{className:"flex justify-between text-xs",style:{color:"var(--text-tertiary)"},children:[(0,a.jsx)("span",{children:"0\xb0 (flat)"}),(0,a.jsx)("span",{children:"22\xb0 (optimal KSA)"}),(0,a.jsx)("span",{children:"45\xb0 (steep)"})]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"block text-sm font-medium",style:{color:"var(--text-primary)"},children:"Shading level"}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-2",children:S.map(e=>{let n=t.shadingLoss===e.value;return(0,a.jsx)("button",{type:"button",onClick:()=>r({shadingLoss:e.value}),title:e.description,className:"py-2 px-3 rounded-lg text-xs font-medium transition-colors",style:n?w():C(),onMouseEnter:e=>{n||(e.currentTarget.style.backgroundColor="var(--bg-elevated)")},onMouseLeave:e=>{n||(e.currentTarget.style.backgroundColor="var(--bg-secondary)")},children:e.label},e.value)})})]})]})}function M(e){let{value:t,onChange:r}=e,[o,s]=(0,n.useState)("kwh"),[l,m]=(0,n.useState)(""),[u,x]=(0,n.useState)(null);return(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>s("kwh"),className:"flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-colors",style:"kwh"===o?{backgroundColor:"var(--accent)",color:"#0C0E14"}:{backgroundColor:"var(--bg-secondary)",color:"var(--text-secondary)"},onMouseEnter:e=>{"kwh"!==o&&(e.currentTarget.style.backgroundColor="var(--bg-elevated)")},onMouseLeave:e=>{"kwh"!==o&&(e.currentTarget.style.backgroundColor="var(--bg-secondary)")},children:"I know my kWh"}),(0,a.jsx)("button",{type:"button",onClick:()=>s("sar"),className:"flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-colors",style:"sar"===o?{backgroundColor:"var(--accent)",color:"#0C0E14"}:{backgroundColor:"var(--bg-secondary)",color:"var(--text-secondary)"},onMouseEnter:e=>{"sar"!==o&&(e.currentTarget.style.backgroundColor="var(--bg-elevated)")},onMouseLeave:e=>{"sar"!==o&&(e.currentTarget.style.backgroundColor="var(--bg-secondary)")},children:"I only have SAR amount"})]}),"kwh"===o?(0,a.jsx)(j,{label:"Monthly electricity consumption",type:"number",min:100,max:5e4,step:100,suffix:"kWh/mo",value:t.monthlyKwh,onChange:e=>r({monthlyKwh:parseFloat(e.target.value)||0}),hint:"From your last electricity bill. Use the average of 3–6 months for best accuracy."}):(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(j,{label:"Monthly electricity bill",type:"number",min:10,max:5e4,step:10,prefix:"SAR",value:l,onChange:e=>(function(e){m(e);let t=parseFloat(e);if(!isNaN(t)&&t>0){let e=function(e){if(e<=0)return null;let t=i*c;return e<=t?e/c:i+(e-t)/d}(t);x(e?Math.round(e):null),e&&r({monthlyKwh:Math.round(e)})}})(e.target.value),hint:"Enter your bill amount — we'll estimate kWh using SEC tiered rates"}),null!==u&&(0,a.jsxs)("div",{className:"rounded-lg px-3 py-2",style:{backgroundColor:"var(--accent-soft)",border:"1px solid var(--accent)"},children:[(0,a.jsxs)("p",{className:"text-sm",style:{color:"var(--accent)"},children:["Estimated consumption: ",(0,a.jsxs)("strong",{children:[u.toLocaleString()," kWh/mo"]})]}),(0,a.jsx)("p",{className:"text-xs mt-0.5",style:{color:"var(--accent)"},children:"This is an estimate based on SEC residential tariff tiers. The actual value may differ due to fixed charges, VAT, or your customer category."})]})]}),(0,a.jsx)("div",{className:"rounded-lg px-3 py-2.5",style:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border)"},children:(0,a.jsxs)("p",{className:"text-xs",style:{color:"var(--text-secondary)"},children:[(0,a.jsx)("span",{className:"font-medium",style:{color:"var(--text-primary)"},children:"Residential tariff applied"})," — Tier 1: 0.18 SAR/kWh (0–6,000 kWh/mo), Tier 2: 0.30 SAR/kWh (above 6,000 kWh/mo). Commercial or custom rates can be set in Advanced Settings."]})})]})}function F(e){var t;let{value:r,onChange:n}=e;return(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",style:{color:"var(--text-primary)"},children:"Do you export excess electricity to the grid?"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[[{label:"No",enabled:!1},{label:"Yes",enabled:!0}].map(e=>{let t=r.enabled===e.enabled;return(0,a.jsx)("button",{type:"button",onClick:()=>n({enabled:e.enabled}),className:"py-2 px-3 rounded-lg text-sm font-medium transition-colors",style:t?{backgroundColor:"var(--accent)",color:"#0C0E14"}:{backgroundColor:"var(--bg-secondary)",color:"var(--text-secondary)"},onMouseEnter:e=>{t||(e.currentTarget.style.backgroundColor="var(--bg-elevated)")},onMouseLeave:e=>{t||(e.currentTarget.style.backgroundColor="var(--bg-secondary)")},children:e.label},e.label)}),(0,a.jsx)("button",{type:"button",onClick:()=>n({enabled:!1}),className:"py-2 px-3 rounded-lg text-sm font-medium transition-colors",style:{backgroundColor:"var(--bg-secondary)",color:"var(--text-secondary)"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="var(--bg-elevated)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="var(--bg-secondary)"},children:"Not sure"})]})]}),r.enabled&&(0,a.jsxs)("div",{className:"space-y-2 pl-4",style:{borderLeft:"2px solid var(--accent)"},children:[(0,a.jsx)(j,{label:"Export credit rate",type:"number",min:0,max:.5,step:.01,prefix:"SAR",suffix:"/kWh",placeholder:"e.g. 0.06",value:null!=(t=r.creditRatePerKwh)?t:"",onChange:e=>{let t=parseFloat(e.target.value);n({creditRatePerKwh:isNaN(t)?null:t})},hint:"From your SEC net-billing agreement. Leave blank if unknown — export credit is never assumed."}),null===r.creditRatePerKwh&&(0,a.jsx)("div",{className:"rounded-lg px-3 py-2",style:{backgroundColor:"var(--info-soft)",border:"1px solid var(--info)"},children:(0,a.jsxs)("p",{className:"text-xs",style:{color:"var(--info)"},children:[(0,a.jsx)("span",{className:"font-medium",children:"Export credit not set."})," Savings will be calculated without export revenue. Enter your confirmed rate from SEC to include it."]})})]})]})}function A(e){let{value:t,onChange:r,onReset:o}=e,[s,i]=(0,n.useState)(!1),c=[{key:"wPerM2",label:"Panel power density",unit:"W/m\xb2",min:150,max:350,step:1,source:l.pvSystem.source},{key:"packingFactor",label:"Packing factor",unit:"(0–1)",min:.5,max:1,step:.05,source:l.pvSystem.source},{key:"systemLoss",label:"System losses",unit:"%",min:0,max:50,step:.5,source:l.pvSystem.source},{key:"degradationPct",label:"Annual degradation",unit:"%/yr",min:0,max:2,step:.1,source:l.pvSystem.source},{key:"installCostPerKwp",label:"Install cost",unit:"SAR/kWp",min:1e3,max:1e4,step:100,source:l.economics.source},{key:"omCostPerKwpPerYear",label:"O&M cost",unit:"SAR/kWp/yr",min:0,max:500,step:10,source:l.economics.source},{key:"projectLifeYears",label:"Project lifetime",unit:"years",min:10,max:30,step:1,source:l.economics.source}];return(0,a.jsxs)("div",{className:"overflow-hidden",style:{border:"1px solid var(--border)",borderRadius:"var(--radius-md)"},children:[(0,a.jsxs)("button",{type:"button",onClick:()=>i(!s),className:"w-full flex items-center justify-between px-4 py-3 text-sm font-medium transition-colors",style:{backgroundColor:"var(--bg-secondary)",color:"var(--text-primary)",fontFamily:"var(--font-syne)"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="var(--bg-elevated)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="var(--bg-secondary)"},children:[(0,a.jsx)("span",{children:"Advanced assumptions"}),(0,a.jsx)("svg",{className:"h-4 w-4 transition-transform ".concat(s?"rotate-180":""),style:{color:"var(--text-tertiary)"},fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),s&&(0,a.jsxs)("div",{className:"p-4 space-y-4",children:[c.map(e=>(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)(j,{label:e.label,type:"number",min:e.min,max:e.max,step:e.step,suffix:e.unit,value:t[e.key],onChange:t=>r({[e.key]:parseFloat(t.target.value)||0})}),(0,a.jsxs)("p",{className:"text-xs",style:{color:"var(--text-tertiary)",fontFamily:"var(--font-newsreader)",fontStyle:"italic"},children:["Source: ",e.source.split(".")[0]]})]},e.key)),(0,a.jsx)(g.$,{variant:"ghost",size:"sm",onClick:o,type:"button",children:"Reset all to defaults"})]})]})}var P=r(1873),E=r(5993),z=r(6154),R=r(6630),I=r(9427);let W=[{id:"location",label:"Location",icon:P.A},{id:"roof",label:"Roof",icon:E.A},{id:"consumption",label:"Usage",icon:z.A},{id:"options",label:"Options",icon:R.A}];function T(e){var t;let{estimator:r}=e,{inputs:n,step:o,setStep:s,updateCity:l,updateRoof:i,updateConsumption:c,updateAdvanced:d,updateExport:m,resetToDefaults:u,runEstimation:x,isLoading:p,defaultInputs:y}=r,v=W.findIndex(e=>e.id===o);return(0,a.jsxs)("div",{style:{backgroundColor:"var(--bg-card)",border:"1px solid var(--border)",borderRadius:"var(--radius-lg)"},className:"shadow-sm overflow-hidden",children:[(0,a.jsx)("div",{className:"flex",style:{borderBottom:"1px solid var(--border)"},children:W.map((e,t)=>{let r=e.icon;return(0,a.jsxs)("button",{type:"button",onClick:()=>s(e.id),className:"flex-1 py-3 text-center transition-colors",style:e.id===o?{backgroundColor:"var(--accent-soft)",borderBottom:"2px solid var(--accent)",color:"var(--accent)"}:t<v?{color:"var(--success)"}:{color:"var(--text-tertiary)"},onMouseEnter:t=>{e.id!==o&&(t.currentTarget.style.backgroundColor="var(--bg-secondary)")},onMouseLeave:t=>{e.id!==o?t.currentTarget.style.backgroundColor="":t.currentTarget.style.backgroundColor="var(--accent-soft)"},children:[(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)(r,{size:18})}),(0,a.jsx)("div",{className:"text-xs font-medium hidden sm:block",children:e.label})]},e.id)})}),(0,a.jsxs)("div",{className:"p-5 space-y-5",children:["location"===o&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-base",style:{color:"var(--text-primary)",fontFamily:"var(--font-syne)",fontWeight:600},children:"Select your city"}),(0,a.jsx)("p",{className:"text-xs mt-0.5",style:{color:"var(--text-secondary)",fontFamily:"var(--font-newsreader)"},children:"Solar data will be fetched from PVGIS for this location."})]}),(0,a.jsx)(f,{value:n.city,onChange:l})]}),"roof"===o&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-base",style:{color:"var(--text-primary)",fontFamily:"var(--font-syne)",fontWeight:600},children:"Your rooftop"}),(0,a.jsx)("p",{className:"text-xs mt-0.5",style:{color:"var(--text-secondary)",fontFamily:"var(--font-newsreader)"},children:"Enter the usable area available for solar panels."})]}),(0,a.jsx)(N,{value:n.roof,onChange:i})]}),"consumption"===o&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-base",style:{color:"var(--text-primary)",fontFamily:"var(--font-syne)",fontWeight:600},children:"Electricity consumption"}),(0,a.jsx)("p",{className:"text-xs mt-0.5",style:{color:"var(--text-secondary)",fontFamily:"var(--font-newsreader)"},children:"From your last electricity bill. The more accurate, the better."})]}),(0,a.jsx)(M,{value:n.consumption,onChange:c})]}),"options"===o&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-base",style:{color:"var(--text-primary)",fontFamily:"var(--font-syne)",fontWeight:600},children:"Options"}),(0,a.jsx)("p",{className:"text-xs mt-0.5",style:{color:"var(--text-secondary)",fontFamily:"var(--font-newsreader)"},children:"Export to grid and installation cost (optional)."})]}),(0,a.jsx)(F,{value:n.export,onChange:m}),(0,a.jsx)(A,{value:n.advanced,onChange:d,onReset:()=>d(y.advanced)})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-2",children:[v>0&&(0,a.jsx)(g.$,{variant:"secondary",onClick:function(){let e=v-1;e>=0&&s(W[e].id)},type:"button",className:"flex-1",children:"← Back"}),"options"!==o?(0,a.jsx)(g.$,{variant:"primary",onClick:function(){let e=v+1;e<W.length&&s(W[e].id)},disabled:!function(){switch(o){case"location":return null!==n.city;case"roof":return n.roof.usableAreaM2>0;case"consumption":return n.consumption.monthlyKwh>0;default:return!0}}(),type:"button",className:"flex-1",children:"Next →"}):(0,a.jsx)(g.$,{variant:"primary",onClick:x,isLoading:p,type:"button",className:"flex-1",children:p?"Calculating…":(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(I.A,{size:16,style:{marginRight:6}})," Calculate My Solar Savings"]})})]}),"options"===o&&(0,a.jsxs)("div",{className:"text-xs px-3 py-2 space-y-0.5",style:{backgroundColor:"var(--bg-secondary)",color:"var(--text-secondary)",borderRadius:"var(--radius-md)"},children:[(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)(P.A,{size:14})," ",null==(t=n.city)?void 0:t.nameEn]}),(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)(E.A,{size:14})," ",n.roof.usableAreaM2," m\xb2 usable roof"]}),(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)(z.A,{size:14})," ",n.consumption.monthlyKwh.toLocaleString()," kWh/mo"]})]})]})]})}function K(e,t){var r;let a=null!=(r=null==t?void 0:t.decimals)?r:0,n=new Intl.NumberFormat("en-US",{minimumFractionDigits:a,maximumFractionDigits:a}).format(e);return"SAR ".concat(n)}function L(e){let t=new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:3}).format(e);return"".concat(t," kWp")}function D(e,t){let r=null!=t?t:0,a=new Intl.NumberFormat("en-US",{minimumFractionDigits:r,maximumFractionDigits:r}).format(e);return"".concat(a,"%")}function Y(e){return e<1?"< 1 year":e>25?"> 25 years":"".concat(e.toFixed(1)," years")}function O(e){let{result:t}=e,{savings:r,economics:n,tariff:o,annualProductionKwh:s}=t,l=r.minSarPerYear/12,i=r.maxSarPerYear/12,c=o.annualBill/o.blendedRate,d=c>0?Math.min(100,Math.round(r.maxKwhSelfConsumedPerYear/c*100)):0,m=n?n.co2OffsetTonnesPerYear:57e-5*s;return(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[(0,a.jsxs)("div",{className:"animate-accentPulse",style:{backgroundColor:"var(--bg-card)",border:"2px solid var(--accent)",borderRadius:"var(--radius-xl)",padding:"24px"},children:[(0,a.jsx)("div",{className:"accent-line",style:{marginBottom:"12px"}}),(0,a.jsx)("p",{style:{fontSize:"0.75rem",fontFamily:"var(--font-syne)",color:"var(--text-secondary)",margin:"0 0 6px",textTransform:"uppercase",letterSpacing:"0.1em"},children:"Estimated Monthly Savings"}),(0,a.jsx)("p",{style:{fontSize:"2.25rem",fontWeight:700,color:"var(--accent)",margin:"0 0 4px",fontFamily:"var(--font-syne)",letterSpacing:"-0.02em"},children:function(e,t){let r=new Intl.NumberFormat("en-US",{maximumFractionDigits:0}).format(e),a=new Intl.NumberFormat("en-US",{maximumFractionDigits:0}).format(t);return"SAR ".concat(r," – ").concat(a," / month")}(l,i)}),(0,a.jsxs)("p",{style:{fontSize:"0.8rem",fontFamily:"var(--font-newsreader)",fontStyle:"italic",color:"var(--text-secondary)",margin:0},children:["Based on ",r.selfConsumptionRangePct[0],"–",r.selfConsumptionRangePct[1],"% self-consumption range"]})]}),(0,a.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"12px"},children:[(0,a.jsx)(B,{label:"Bill coverage",value:D(d),subtext:"of your electricity need"}),(0,a.jsx)(B,{label:"Annual savings",value:function(e,t,r){let a=new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}).format(e),n=new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}).format(t),o="SAR ".concat(a," – ").concat(n);if(r){let e=r.startsWith("SAR")?r.slice(3):" ".concat(r);return"".concat(o," ").concat(e)}return o}(r.minSarPerYear,r.maxSarPerYear,"SAR/yr"),subtext:"conservative estimate"}),n&&(0,a.jsx)(B,{label:"Payback period",value:Y(n.simplePaybackYears),subtext:n.simplePaybackYears>25?"exceeds panel lifetime":"to recover investment",highlight:!0}),(0,a.jsx)(B,{label:"CO₂ offset",value:function(e){let t=new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:1}).format(e);return"".concat(t," tonnes CO₂/yr")}(m),subtext:"emissions avoided"})]})]})}function B(e){let{label:t,value:r,subtext:n,highlight:o}=e;return(0,a.jsxs)("div",{style:{backgroundColor:"var(--bg-card)",border:"1px solid ".concat(o?"var(--accent)":"var(--border)"),borderRadius:"var(--radius-lg)",padding:"16px"},children:[(0,a.jsx)("p",{style:{fontSize:"0.7rem",fontFamily:"var(--font-syne)",color:"var(--text-secondary)",margin:"0 0 4px",textTransform:"uppercase",letterSpacing:"0.06em"},children:t}),(0,a.jsx)("p",{style:{fontSize:"1rem",fontWeight:500,color:o?"var(--accent)":"var(--text-primary)",margin:"0 0 2px",fontFamily:"var(--font-ibm-plex-mono)"},children:r}),(0,a.jsx)("p",{style:{fontSize:"0.7rem",fontFamily:"var(--font-newsreader)",color:"var(--text-secondary)",margin:0},children:n})]})}var U=r(6265),H=r(9863),V=r(8425),J=r(7734),q=r(3697),G=r(3420),$=r(46),_=r(2321),X=r(9476),Q=r(4621);function Z(e){let{children:t,className:r,padding:n="md"}=e;return(0,a.jsx)("div",{className:(0,b.$)("card-hover",{"p-0":"none"===n,"p-4":"sm"===n,"p-5":"md"===n,"p-6":"lg"===n},r),style:{backgroundColor:"var(--bg-card)",border:"1px solid var(--border)",borderRadius:"var(--radius-lg)"},children:t})}function ee(e){let{children:t,className:r}=e;return(0,a.jsx)("h3",{className:(0,b.$)("text-sm font-semibold uppercase tracking-wide",r),style:{color:"var(--text-secondary)",fontFamily:"var(--font-syne)",letterSpacing:"0.06em"},children:t})}let et={default:{backgroundColor:"var(--bg-secondary)",color:"var(--text-secondary)"},success:{backgroundColor:"var(--success-soft)",color:"var(--success)"},warning:{backgroundColor:"var(--warning-soft)",color:"var(--warning)"},info:{backgroundColor:"var(--info-soft)",color:"var(--info)"}};function er(e){let{children:t,variant:r="default",className:n}=e;return(0,a.jsx)("span",{className:(0,b.$)("inline-flex items-center gap-1 px-2 py-0.5 text-xs",n),style:{borderRadius:"9999px",fontFamily:"var(--font-syne)",fontWeight:500,...et[r]},children:t})}let ea={accent:"#E8A832",accentHover:"#D4952A",accentGlow:"rgba(232,168,50,0.15)",border:"#252A3A",textPrimary:"#F0EDE6",textSecondary:"#8A8FA0",textTertiary:"#5C6070",success:"#34D399",warning:"#F59E0B",bgElevated:"#1E2333",bgCard:"#181C28",bgSecondary:"#131620"};function en(){let e=getComputedStyle(document.documentElement),t=(t,r)=>e.getPropertyValue(t).trim()||r;return{accent:t("--accent",ea.accent),accentHover:t("--accent-hover",ea.accentHover),accentGlow:t("--accent-glow",ea.accentGlow),border:t("--border",ea.border),textPrimary:t("--text-primary",ea.textPrimary),textSecondary:t("--text-secondary",ea.textSecondary),textTertiary:t("--text-tertiary",ea.textTertiary),success:t("--success",ea.success),warning:t("--warning",ea.warning),bgElevated:t("--bg-elevated",ea.bgElevated),bgCard:t("--bg-card",ea.bgCard),bgSecondary:t("--bg-secondary",ea.bgSecondary)}}function eo(){let[e,t]=(0,n.useState)(ea);return(0,n.useEffect)(()=>{t(en())},[]),(0,n.useEffect)(()=>{let e=new MutationObserver(()=>{requestAnimationFrame(()=>t(en()))});return e.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>e.disconnect()},[]),e}function es(e){var t;let{active:r,payload:n,label:o}=e;if(!r||!(null==n?void 0:n.length))return null;let s=null==(t=n[0])?void 0:t.payload;return(0,a.jsxs)("div",{style:{backgroundColor:"var(--bg-elevated)",border:"1px solid var(--border)",borderRadius:"var(--radius-md)",boxShadow:"0 8px 24px rgba(0,0,0,0.2)",padding:"12px",fontSize:"0.75rem",display:"flex",flexDirection:"column",gap:"4px"},children:[(0,a.jsx)("p",{style:{fontWeight:600,color:"var(--text-primary)",margin:0},children:o}),(0,a.jsxs)("p",{style:{color:"var(--accent)",margin:0},children:["Production: ",s.productionKwh.toLocaleString()," kWh"]}),(0,a.jsxs)("p",{style:{color:"var(--text-secondary)",margin:0},children:["Consumption: ",s.consumptionKwh.toLocaleString()," kWh"]}),(0,a.jsxs)("p",{style:{color:"var(--success)",fontWeight:500,margin:0},children:["Savings: SAR ",s.savingsMinSar.toLocaleString()," – ",s.savingsMaxSar.toLocaleString()]})]})}function el(e){let{data:t}=e,r=eo(),n=t.map(e=>({month:e.month,production:e.productionKwh,consumption:e.consumptionKwh,savingsMin:e.savingsMinSar,savingsMax:e.savingsMaxSar,productionKwh:e.productionKwh,consumptionKwh:e.consumptionKwh,savingsMinSar:e.savingsMinSar,savingsMaxSar:e.savingsMaxSar}));return(0,a.jsxs)(Z,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)(ee,{children:"Monthly Production vs Consumption"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(er,{variant:"warning",children:"Solar production"}),(0,a.jsx)(er,{variant:"success",children:"Savings range"})]})]}),(0,a.jsx)(U.u,{width:"100%",height:300,children:(0,a.jsxs)(H.X,{data:n,margin:{top:4,right:16,left:0,bottom:0},children:[(0,a.jsx)(V.d,{strokeDasharray:"3 3",stroke:r.border}),(0,a.jsx)(J.W,{dataKey:"month",tick:{fontSize:11,fill:r.textSecondary},axisLine:!1,tickLine:!1}),(0,a.jsx)(q.h,{yAxisId:"kwh",orientation:"left",tick:{fontSize:10,fill:r.textSecondary},axisLine:!1,tickLine:!1,tickFormatter:e=>"".concat((e/1e3).toFixed(0),"k"),label:{value:"kWh",angle:-90,position:"insideLeft",fontSize:10,fill:r.textSecondary}}),(0,a.jsx)(q.h,{yAxisId:"sar",orientation:"right",tick:{fontSize:10,fill:r.textSecondary},axisLine:!1,tickLine:!1,tickFormatter:e=>"".concat(e),label:{value:"SAR",angle:90,position:"insideRight",fontSize:10,fill:r.textSecondary}}),(0,a.jsx)(G.m,{content:(0,a.jsx)(es,{})}),(0,a.jsx)($.s,{wrapperStyle:{fontSize:11,color:r.textSecondary},formatter:e=>{var t;return null!=(t=({production:"Solar Production (kWh)",consumption:"Consumption (kWh)",savingsMax:"Savings High (SAR)",savingsMin:"Savings Low (SAR)"})[e])?t:e}}),(0,a.jsx)(_.yP,{yAxisId:"kwh",dataKey:"production",fill:r.accent,radius:[3,3,0,0],name:"production",maxBarSize:32}),(0,a.jsx)(X.N1,{yAxisId:"kwh",type:"monotone",dataKey:"consumption",stroke:r.textSecondary,strokeWidth:1.5,dot:!1,name:"consumption",strokeDasharray:"4 4"}),(0,a.jsx)(Q.Gk,{yAxisId:"sar",type:"monotone",dataKey:"savingsMax",fill:r.success,stroke:"none",name:"savingsMax",fillOpacity:.15}),(0,a.jsx)(X.N1,{yAxisId:"sar",type:"monotone",dataKey:"savingsMin",stroke:r.success,strokeWidth:1.5,dot:!1,name:"savingsMin"}),(0,a.jsx)(X.N1,{yAxisId:"sar",type:"monotone",dataKey:"savingsMax",stroke:r.success,strokeWidth:1.5,dot:!1,strokeDasharray:"5 3"})]})}),(0,a.jsx)("p",{style:{color:"var(--text-tertiary)",fontFamily:"var(--font-newsreader)",fontStyle:"italic",fontSize:"0.75rem",marginTop:"8px",textAlign:"center"},children:"Shaded green band = savings range (conservative 20–40% self-consumption). Dashed grey line = monthly average consumption."})]})}function ei(e){let{label:t,value:r,min:n,max:o,step:s,unit:l,onChange:i,disabled:c,disabledReason:d}=e;return(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,a.jsx)("span",{style:{fontFamily:"var(--font-syne)",fontSize:"0.75rem",fontWeight:500,color:"var(--text-primary)"},children:t}),(0,a.jsx)("span",{style:{fontFamily:"var(--font-ibm-plex-mono)",color:c?"var(--text-tertiary)":"var(--accent)",fontWeight:c?400:600},children:c?"—":"".concat(r).concat(l)})]}),(0,a.jsx)("input",{type:"range",min:n,max:o,step:s,value:r,disabled:c,onChange:e=>i(parseFloat(e.target.value)),className:"w-full accent-amber-500 disabled:accent-slate-200"}),c&&d&&(0,a.jsx)("p",{className:"text-xs",style:{color:"var(--text-tertiary)"},children:d}),!c&&(0,a.jsxs)("div",{className:"flex justify-between text-xs",style:{color:"var(--text-tertiary)"},children:[(0,a.jsxs)("span",{children:[n,l]}),(0,a.jsxs)("span",{children:[o,l]})]})]})}function ec(e){var t;let{estimator:r}=e,{inputs:n,updateAdvanced:o,updateExport:s,runEstimation:l}=r,i=n.export.enabled;return(0,a.jsxs)(Z,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)(ee,{children:"Sensitivity"}),(0,a.jsx)("button",{type:"button",onClick:l,className:"text-xs font-medium",style:{color:"var(--accent)",fontFamily:"var(--font-syne)"},children:"Recalculate ↻"})]}),(0,a.jsxs)("div",{className:"space-y-5",children:[(0,a.jsx)(ei,{label:"System losses",value:n.advanced.systemLoss,min:5,max:30,step:.5,unit:"%",onChange:e=>o({systemLoss:e})}),(0,a.jsx)(ei,{label:"Panel power density",value:n.advanced.wPerM2,min:180,max:310,step:2,unit:" W/m\xb2",onChange:e=>o({wPerM2:e})}),(0,a.jsx)(ei,{label:"Self-consumption",value:null!=n.advanced.selfConsumptionOverride?Math.round(100*n.advanced.selfConsumptionOverride):45,min:15,max:70,step:5,unit:"%",onChange:e=>o({selfConsumptionOverride:e/100})}),(0,a.jsx)(ei,{label:"Export credit rate",value:null!=(t=n.export.creditRatePerKwh)?t:0,min:0,max:.3,step:.01,unit:" SAR/kWh",disabled:!i||null===n.export.creditRatePerKwh,disabledReason:i?"Enter a confirmed rate in Options to enable this slider":"Enable net billing in Options to set export rate",onChange:e=>s({creditRatePerKwh:e})})]}),(0,a.jsx)("p",{className:"text-xs mt-4",style:{fontFamily:"var(--font-newsreader)",color:"var(--text-tertiary)"},children:"Adjust sliders, then click Recalculate to update results."})]})}function ed(e){let{usableAreaM2:t,systemKwp:r,roofCoverage:n,panelCount:o}=e,s=eo(),l=Math.PI,i=n/100*Math.PI;function c(e,t){return{x:80+t*Math.cos(e),y:100-t*Math.sin(e)}}let d=c(l,60),m=c(0,60),u=c(l-i,60),x="M ".concat(d.x," ").concat(d.y," A ").concat(60," ").concat(60," 0 0 1 ").concat(m.x," ").concat(m.y),p=i>0?"M ".concat(d.x," ").concat(d.y," A ").concat(60," ").concat(60," 0 ").concat(+(i>Math.PI/2)," 1 ").concat(u.x," ").concat(u.y):"",y=n>=70?s.accent:n>=40?"#FACC15":s.border;return(0,a.jsxs)(Z,{children:[(0,a.jsx)(ee,{className:"mb-3",children:"Roof Utilisation"}),(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsxs)("svg",{width:160,height:110,viewBox:"0 0 ".concat(160," ").concat(110),children:[(0,a.jsx)("path",{d:x,fill:"none",stroke:s.border,strokeWidth:14,strokeLinecap:"round"}),p&&(0,a.jsx)("path",{d:p,fill:"none",stroke:y,strokeWidth:14,strokeLinecap:"round",style:{transition:"stroke-dashoffset 0.6s ease"}}),(0,a.jsxs)("text",{x:80,y:96,textAnchor:"middle",fontSize:"22",fontWeight:"bold",fill:s.textPrimary,fontFamily:"var(--font-syne)",children:[n,"%"]}),(0,a.jsx)("text",{x:80,y:114,textAnchor:"middle",fontSize:"10",fill:s.textSecondary,children:"roof used"})]}),(0,a.jsxs)("div",{className:"w-full mt-2 space-y-1 text-xs",style:{color:"var(--text-secondary)"},children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Usable area"}),(0,a.jsxs)("span",{style:{fontWeight:500,fontFamily:"var(--font-ibm-plex-mono)"},children:[t," m\xb2"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"System size"}),(0,a.jsx)("span",{style:{fontWeight:500,fontFamily:"var(--font-ibm-plex-mono)",color:"var(--accent)"},children:L(r)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Est. panels"}),(0,a.jsxs)("span",{style:{fontWeight:500,fontFamily:"var(--font-ibm-plex-mono)"},children:["~",o]})]})]})]})]})}function em(e){let{economics:t}=e,r=eo(),n=t.simplePaybackYears,o=n>25,s=n>50,l=Math.min(n/25*100,100),i=o?r.warning:r.accent,c=s?"N/A":n>25?"25+":n.toFixed(1),d=o?function(e){let{totalInstallCostSar:t,annualSavingsRangeMin:r,annualSavingsRangeMax:a}=e,n=(r+a)/2,o=n>0?25*n:null;return{requiredNetSavingsPerYear:Math.round(t/25),requiredInstallCostSar:null!=o?Math.round(o):null}}(t):null;return(0,a.jsxs)("div",{className:"geo-border",style:{backgroundColor:"var(--bg-card)",border:"1px solid var(--border)",borderRadius:"16px",padding:"24px",transition:"all 0.3s ease-out"},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"20px"},children:[(0,a.jsx)("div",{className:"accent-line"}),(0,a.jsx)("h3",{style:{fontFamily:"var(--font-syne)",fontWeight:600,fontSize:"1rem",color:"var(--text-primary)",margin:0},children:"Investment Analysis"})]}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"20px",marginBottom:"20px"},children:[(0,a.jsx)("div",{style:{position:"relative",width:80,height:80,flexShrink:0},children:(0,a.jsxs)("svg",{width:"80",height:"80",viewBox:"0 0 80 80",children:[(0,a.jsx)("circle",{cx:"40",cy:"40",r:"34",fill:"none",stroke:r.border,strokeWidth:"6"}),(0,a.jsx)("circle",{cx:"40",cy:"40",r:"34",fill:"none",stroke:i,strokeWidth:"6",strokeLinecap:"round",strokeDasharray:"".concat(2*Math.PI*34),strokeDashoffset:"".concat(2*Math.PI*34*(1-l/100)),transform:"rotate(-90 40 40)",style:{transition:"stroke-dashoffset 1s ease"}}),(0,a.jsx)("text",{x:"40",y:"38",textAnchor:"middle",fontSize:"1.1rem",fontWeight:"700",fill:r.textPrimary,fontFamily:"var(--font-ibm-plex-mono)",children:c}),(0,a.jsx)("text",{x:"40",y:"52",textAnchor:"middle",fontSize:"0.6rem",fill:r.textSecondary,fontFamily:"var(--font-ibm-plex-mono)",children:"yrs"})]})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{style:{fontSize:"1.1rem",fontWeight:600,color:"var(--text-primary)",margin:"0 0 4px"},children:[s?"Not viable":Y(n)," payback"]}),(0,a.jsx)("p",{style:{fontSize:"0.8rem",color:"var(--text-secondary)",margin:0},children:"of a 25-year panel lifespan"})]})]}),o&&(0,a.jsxs)("div",{style:{backgroundColor:"var(--warning-soft)",border:"1px solid var(--warning)",borderRadius:"10px",padding:"12px 14px",marginBottom:"16px"},children:[(0,a.jsx)("p",{style:{fontSize:"0.8rem",fontWeight:600,color:"var(--text-primary)",margin:"0 0 4px"},children:s?"Investment does not pay back without export credits":"Payback exceeds panel lifetime (25 years)"}),(0,a.jsx)("p",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",margin:0},children:"Saudi electricity rates (0.18 SAR/kWh) are heavily subsidized, making solar ROI challenging. Try: increase self-consumption via the slider, enable net billing with export credits, or find a lower installation cost."})]}),d&&(0,a.jsxs)("div",{style:{backgroundColor:"var(--bg-secondary)",borderRadius:"10px",padding:"12px 14px",marginBottom:"16px"},children:[(0,a.jsx)("p",{style:{fontSize:"0.7rem",fontWeight:600,color:"var(--text-secondary)",margin:"0 0 8px",textTransform:"uppercase",letterSpacing:"0.05em"},children:"To reach 25-year payback"}),(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[(0,a.jsxs)("p",{style:{fontSize:"0.75rem",color:"var(--text-primary)",margin:0},children:["Need annual net savings of ",(0,a.jsxs)("strong",{children:["SAR ",d.requiredNetSavingsPerYear.toLocaleString()]}),"/yr"]}),null!=d.requiredInstallCostSar&&(0,a.jsxs)("p",{style:{fontSize:"0.75rem",color:"var(--text-primary)",margin:0},children:["Or reduce install cost to ",(0,a.jsxs)("strong",{children:["SAR ",d.requiredInstallCostSar.toLocaleString()]})," total"]})]})]}),(0,a.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[(0,a.jsx)(eu,{label:"Cost per panel",value:function(e){if(e<=0)return"N/A";let t=new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}).format(e);return"SAR ".concat(t," / panel")}(t.costPerPanel)}),(0,a.jsx)(eu,{label:"Cost per kWp",value:function(e){if(e<=0)return"N/A";let t=new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}).format(e);return"SAR ".concat(t," / kWp")}(t.costPerKwp)}),(0,a.jsx)(eu,{label:"25-yr net gain",value:K(t.cumulativeSavings25yr),highlight:t.cumulativeSavings25yr>0}),(0,a.jsx)(eu,{label:"NPV (today)",value:K(t.npv25Years),highlight:t.npv25Years>0})]})]})}function eu(e){let{label:t,value:r,highlight:n}=e;return(0,a.jsxs)("div",{style:{backgroundColor:"var(--bg-secondary)",borderRadius:"var(--radius-md)",padding:"12px"},children:[(0,a.jsx)("p",{style:{fontSize:"0.7rem",fontFamily:"var(--font-syne)",color:"var(--text-secondary)",margin:"0 0 4px",textTransform:"uppercase",letterSpacing:"0.05em"},children:t}),(0,a.jsx)("p",{style:{fontSize:"0.9rem",fontWeight:600,margin:0,color:n?"var(--accent)":"var(--text-primary)",fontFamily:"var(--font-ibm-plex-mono)"},children:r})]})}var ex=r(1218),ep=r(3656),ey=r(4947),ev=r(7666);function eh(e){var t;let{comparisons:r}=e,n=[{icon:(0,a.jsx)(ex.A,{size:28,style:{color:"var(--accent)"}}),borderColor:"var(--accent)",label:"Like getting free electricity for",value:(t=r.monthsFreePerYear)<=0?"0 months":"".concat(t.toFixed(1)," months free"),subtext:"every year"},{icon:(0,a.jsx)(ep.A,{size:28,style:{color:"var(--success)"}}),borderColor:"var(--success)",label:"Equivalent to planting",value:"".concat(r.treesEquivalentPerYear," trees"),subtext:"annually (CO₂ offset)"},{icon:(0,a.jsx)(ey.A,{size:28,style:{color:"var(--info)"}}),borderColor:"var(--info)",label:"Like avoiding",value:"".concat(r.carTripsAvoided," car trips"),subtext:"Riyadh → Jeddah per year"},{icon:(0,a.jsx)(ev.A,{size:28,style:{color:"var(--warning)"}}),borderColor:"var(--warning)",label:"Enough electricity for",value:"".concat(r.householdsEquivalent," homes"),subtext:"average Saudi household"}];return(0,a.jsxs)("div",{style:{backgroundColor:"var(--bg-card)",border:"1px solid var(--border)",borderRadius:"16px",padding:"24px",transition:"all 0.3s ease-out"},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"20px"},children:[(0,a.jsx)("div",{className:"accent-line"}),(0,a.jsx)("h3",{style:{fontFamily:"var(--font-syne)",fontWeight:600,fontSize:"1rem",color:"var(--text-primary)",margin:0},children:"What This Means for You"})]}),(0,a.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"12px"},children:n.map(e=>(0,a.jsxs)("div",{style:{backgroundColor:"var(--bg-secondary)",borderRadius:"var(--radius-md)",borderLeft:"3px solid ".concat(e.borderColor),padding:"16px",display:"flex",flexDirection:"column",gap:"6px"},children:[(0,a.jsx)("span",{children:e.icon}),(0,a.jsx)("p",{style:{fontSize:"0.7rem",fontFamily:"var(--font-newsreader)",color:"var(--text-secondary)",margin:0},children:e.label}),(0,a.jsx)("p",{style:{fontSize:"1rem",fontWeight:700,fontFamily:"var(--font-syne)",color:"var(--accent)",margin:0},children:e.value}),(0,a.jsx)("p",{style:{fontSize:"0.7rem",fontFamily:"var(--font-newsreader)",fontStyle:"italic",color:"var(--text-tertiary)",margin:0},children:e.subtext})]},e.label))})]})}function eg(e){let{result:t,inputs:r}=e,[o,s]=(0,n.useState)(!1),l=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return(0,a.jsxs)("div",{style:{border:"1px solid var(--border)",borderRadius:"16px",overflow:"hidden"},children:[(0,a.jsxs)("button",{onClick:()=>s(!o),style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 24px",backgroundColor:"var(--bg-secondary)",border:"none",cursor:"pointer",color:"var(--text-secondary)",fontSize:"0.85rem",fontFamily:"var(--font-syne)"},children:[(0,a.jsx)("span",{children:"Technical Details — For Engineers & Installers"}),(0,a.jsx)("span",{style:{transform:o?"rotate(180deg)":"rotate(0)",transition:"transform 0.3s ease",color:"var(--accent)"},children:"▼"})]}),o&&(0,a.jsxs)("div",{style:{padding:"24px",backgroundColor:"var(--bg-card)"},children:[(0,a.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,a.jsx)("h4",{style:{fontSize:"0.8rem",fontFamily:"var(--font-syne)",fontWeight:600,color:"var(--text-secondary)",textTransform:"uppercase",letterSpacing:"0.08em",margin:"0 0 12px"},children:"System Specifications"}),(0,a.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px"},children:[(0,a.jsx)(ef,{label:"System size",value:L(t.sizing.systemKwp)}),(0,a.jsx)(ef,{label:"Panel count",value:"".concat(t.sizing.panelCount," panels")}),(0,a.jsx)(ef,{label:"Annual production",value:function(e){let t=new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}).format(e);return"".concat(t," kWh")}(t.annualProductionKwh)}),(0,a.jsx)(ef,{label:"Specific yield",value:"".concat(Math.round(t.annualProductionKwh/t.sizing.systemKwp)," kWh/kWp")}),(0,a.jsx)(ef,{label:"System losses",value:D(r.advanced.systemLoss)}),(0,a.jsx)(ef,{label:"Roof coverage",value:D(t.sizing.roofCoverage)})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{style:{fontSize:"0.8rem",fontFamily:"var(--font-syne)",fontWeight:600,color:"var(--text-secondary)",textTransform:"uppercase",letterSpacing:"0.08em",margin:"0 0 12px"},children:"Monthly Production (kWh)"}),(0,a.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(6, 1fr)",gap:"6px"},children:t.monthlyBreakdown.slice(0,12).map((e,t)=>(0,a.jsxs)("div",{style:{textAlign:"center",backgroundColor:"var(--bg-secondary)",borderRadius:"var(--radius-sm)",padding:"8px 4px"},children:[(0,a.jsx)("p",{style:{fontSize:"0.65rem",fontFamily:"var(--font-newsreader)",color:"var(--text-secondary)",margin:"0 0 4px"},children:l[t]}),(0,a.jsx)("p",{style:{fontSize:"0.8rem",fontWeight:600,color:"var(--text-primary)",margin:0,fontFamily:"var(--font-ibm-plex-mono)"},children:Math.round(e.productionKwh)})]},t))})]}),(0,a.jsx)("p",{style:{fontSize:"0.7rem",color:"var(--text-tertiary)",fontFamily:"var(--font-newsreader)",fontStyle:"italic",marginTop:"20px",marginBottom:0,borderTop:"1px solid var(--border)",paddingTop:"16px"},children:"Solar irradiance data: PVGIS-SARAH3 (Joint Research Centre, European Commission). Self-consumption range: Fraunhofer ISE literature (20–40%). Estimates only — verify with a qualified solar installer before investing."})]})]})}function ef(e){let{label:t,value:r}=e;return(0,a.jsxs)("div",{style:{backgroundColor:"var(--bg-secondary)",borderRadius:"var(--radius-sm)",padding:"8px 12px"},children:[(0,a.jsx)("p",{style:{fontSize:"0.65rem",fontFamily:"var(--font-newsreader)",color:"var(--text-secondary)",margin:"0 0 2px"},children:t}),(0,a.jsx)("p",{style:{fontSize:"0.8rem",fontWeight:600,color:"var(--text-primary)",margin:0,fontFamily:"var(--font-ibm-plex-mono)"},children:r})]})}function eb(e){let{className:t}=e;return(0,a.jsx)("div",{className:(0,b.$)("skeleton-shimmer rounded",t)})}function ej(){return(0,a.jsxs)("div",{className:"p-5 space-y-3",style:{backgroundColor:"var(--bg-card)",borderRadius:"var(--radius-lg)",border:"1px solid var(--border)"},children:[(0,a.jsx)(eb,{className:"h-4 w-24"}),(0,a.jsx)(eb,{className:"h-8 w-36"}),(0,a.jsx)(eb,{className:"h-3 w-20"})]})}function eS(){return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[void 0,void 0,void 0,void 0].map((e,t)=>(0,a.jsx)(ej,{},t))}),(0,a.jsxs)("div",{className:"p-5",style:{backgroundColor:"var(--bg-card)",borderRadius:"var(--radius-lg)",border:"1px solid var(--border)"},children:[(0,a.jsx)(eb,{className:"h-4 w-32 mb-4"}),(0,a.jsx)(eb,{className:"h-64 w-full"})]})]})}var ek=r(7494);function ew(){let[e,t]=(0,n.useState)(null);return((0,n.useEffect)(()=>{t("light"===localStorage.getItem("theme")?"light":"dark")},[]),null===e)?null:(0,a.jsx)("button",{onClick:()=>{let r="dark"===e?"light":"dark";t(r),document.documentElement.setAttribute("data-theme",r),localStorage.setItem("theme",r)},"aria-label":"dark"===e?"Switch to light mode":"Switch to dark mode",style:{backgroundColor:"var(--bg-elevated)",border:"1px solid var(--border)",borderRadius:"var(--radius-sm)",padding:"6px 10px",cursor:"pointer",color:"var(--text-secondary)",fontSize:"16px",lineHeight:1,display:"inline-flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s cubic-bezier(0.16, 1, 0.3, 1)"},onMouseEnter:e=>{e.currentTarget.style.borderColor="var(--accent)",e.currentTarget.style.color="var(--accent)",e.currentTarget.style.transform="rotate(15deg)"},onMouseLeave:e=>{e.currentTarget.style.borderColor="var(--border)",e.currentTarget.style.color="var(--text-secondary)",e.currentTarget.style.transform="rotate(0deg)"},children:"dark"===e?(0,a.jsx)(I.A,{size:16}):(0,a.jsx)(ek.A,{size:16})})}var eC=r(2056);function eN(){let e=function(){let[e,t]=(0,n.useState)(h),[r,a]=(0,n.useState)(null),[o,s]=(0,n.useState)(null),[i,c]=(0,n.useState)(!1),[d,p]=(0,n.useState)("location"),[y,g]=(0,n.useState)("conservative"),f=(0,n.useCallback)(e=>{t(t=>({...t,city:e}))},[]),b=(0,n.useCallback)(e=>{t(t=>({...t,roof:{...t.roof,...e}}))},[]),j=(0,n.useCallback)(e=>{t(t=>({...t,consumption:{...t.consumption,...e}}))},[]),S=(0,n.useCallback)(e=>{t(t=>({...t,advanced:{...t.advanced,...e}}))},[]),k=(0,n.useCallback)(e=>{t(t=>({...t,export:{...t.export,...e}}))},[]),w=(0,n.useCallback)(()=>{t(h),a(null),s(null),p("location"),g("conservative")},[]),C=(0,n.useCallback)(async()=>{if(!e.city)return void s("Please select a city.");s(null),c(!0);try{var t;let r,n=function(e,t){let r=Math.round(100*(e.usableAreaM2*(t.wPerM2/1e3)*t.packingFactor))/100,a=Math.floor(1e3*r/400),n=Math.min(100,Math.round(400*a/1e3/(t.wPerM2/1e3*t.packingFactor)/e.usableAreaM2*100));return{systemKwp:r,panelCount:a,roofCoverage:n}}(e.roof,e.advanced),o=((r=e.roof.azimuthDeg-180)>180&&(r-=360),r<-180&&(r+=360),r),s=new URLSearchParams({lat:String(e.city.lat),lon:String(e.city.lon),peakpower:String(n.systemKwp),loss:String(e.advanced.systemLoss),angle:String(e.roof.tiltDeg),aspect:String(o)});e.roof.useOptimalAngles&&s.set("optimalangles","1");let i=await fetch("/api/pvgis?".concat(s.toString()));if(!i.ok){let e=await i.json().catch(()=>({error:"Unknown error"}));throw Error(null!=(t=e.error)?t:"Solar data fetch failed (".concat(i.status,")"))}let c=await i.json(),d=m(e.consumption.monthlyKwh),{savingsRange:p,monthlyBreakdown:h}=function(e,t,r,a,n){var o,s;let i,c,d=e.outputs.monthly.fixed.map(e=>e.E_m),p=(o=t.monthlyKwh,v.map(e=>o*e));if(null!=n&&n>0)i=n,c=n;else switch(a){case"net-billing":case"conservative":default:i=l.selfConsumption.conservativeLow,c=l.selfConsumption.conservativeHigh;break;case"profile":i=l.selfConsumption.profileLow,c=l.selfConsumption.profileHigh}let y=[],h=0,g=0,f=0,b=0;for(let e=0;e<12;e++){let t=null!=(s=d[e])?s:0,n=p[e],o=Math.min(t*i,n),l=Math.min(t*c,n),v=Math.max(0,t-l),j=Math.max(0,t-o),S=m(n),k=u(n,o),w=u(n,l),C=S.monthlyBill-k.monthlyBill,N=S.monthlyBill-w.monthlyBill;"net-billing"===a&&r.enabled&&null!==r.creditRatePerKwh&&(C+=v*r.creditRatePerKwh,N+=j*r.creditRatePerKwh),C=Math.max(0,C),N=Math.max(0,N),h+=C,g+=N,f+=o,b+=l,y.push({month:x[e],monthNum:e+1,productionKwh:Math.round(t),consumptionKwh:Math.round(n),selfConsumedMinKwh:Math.round(o),selfConsumedMaxKwh:Math.round(l),exportedMinKwh:Math.round(v),exportedMaxKwh:Math.round(j),savingsMinSar:Math.round(C),savingsMaxSar:Math.round(N)})}return{savingsRange:{minSarPerYear:Math.round(h),maxSarPerYear:Math.round(g),minKwhSelfConsumedPerYear:Math.round(f),maxKwhSelfConsumedPerYear:Math.round(b),selfConsumptionRangePct:[100*i,100*c]},monthlyBreakdown:y}}(c,e.consumption,e.export,y,e.advanced.selfConsumptionOverride),g=c.outputs.totals.fixed.E_y,f=e.advanced.installCostPerKwp>0?function(e,t,r,a,n){let o=e.systemKwp*t.installCostPerKwp,s=e.systemKwp*t.omCostPerKwpPerYear,i=(a+n)/2,c=l.economics.discountRatePercent/100,d=t.projectLifeYears,m=t.degradationPct/100,u=o/Math.max(i-s,1),x=-o,p=0;for(let e=1;e<=d;e++){let t=Math.pow(1-m,e-1),a=Math.pow(1+c,e);x+=(i*t-s)/a,p+=r*t/a}let y=o/Math.max(p,1),v=function(e,t,r,a,n){let o=.1;for(let s=0;s<20;s++){let s=-e,l=0;for(let e=1;e<=a;e++){let a=(t-r)*Math.pow(1-n,e-1);s+=a/Math.pow(1+o,e),l-=e*a/Math.pow(1+o,e+1)}if(.01>Math.abs(s)||0===l)break;(o-=s/l)<-.99&&(o=-.99),o>10&&(o=10)}return o>-.99?100*o:0}(o,i,s,d,m),h=r*l.economics.gridCO2IntensityKgPerKwh/1e3,g=e.panelCount>0?o/e.panelCount:0,f=e.systemKwp>0?o/e.systemKwp:0,b=-o;for(let e=0;e<25;e++)b+=i*Math.pow(1-m,e)-s;return{simplePaybackYears:Math.round(10*u)/10,npv25Years:Math.round(x),irr:Math.round(10*v)/10,lcoe:Math.round(1e3*y)/1e3,totalInstallCostSar:Math.round(o),annualSavingsRangeMin:a,annualSavingsRangeMax:n,co2OffsetTonsPerYear:Math.round(10*h)/10,costPerPanel:Math.round(g),costPerKwp:Math.round(f),cumulativeSavings25yr:Math.round(b),monthlySavingsMin:Math.round(a/12*100)/100,monthlySavingsMax:Math.round(n/12*100)/100,co2OffsetTonnesPerYear:Math.round(57e-5*r*100)/100}}(n,e.advanced,g,p.minSarPerYear,p.maxSarPerYear):null,b=(p.minSarPerYear+p.maxSarPerYear)/2,j=d.monthlyBill,S=f?f.co2OffsetTonnesPerYear:57e-5*g,k={monthsFreePerYear:j>0?b/j:0,treesEquivalentPerYear:Math.round(1e3*S/21),carTripsAvoided:Math.round(1e3*S/180),householdsEquivalent:Number((g/36e3).toFixed(1))};a({sizing:n,pvgisData:c,tariff:d,savings:p,monthlyBreakdown:h,economics:f,citizenComparisons:k,mode:y,annualProductionKwh:g,computedAt:Date.now()})}catch(e){s(e instanceof Error?e.message:"Estimation failed. Please try again.")}finally{c(!1)}},[e,y]);return{inputs:e,result:r,error:o,isLoading:i,step:d,savingsMode:y,setStep:p,setSavingsMode:g,updateCity:f,updateRoof:b,updateConsumption:j,updateAdvanced:S,updateExport:k,resetToDefaults:w,runEstimation:C,defaultInputs:h}}(),{result:t,isLoading:r,error:o}=e;return(0,a.jsxs)("div",{className:"min-h-screen",style:{backgroundColor:"var(--bg-primary)"},children:[(0,a.jsx)("header",{className:"sticky top-0 z-40 geo-border",style:{backgroundColor:"color-mix(in srgb, var(--bg-secondary) 85%, transparent)",borderBottom:"1px solid var(--border)",backdropFilter:"blur(12px)",WebkitBackdropFilter:"blur(12px)"},children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-3 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"animate-accentPulse",style:{width:40,height:40,borderRadius:"50%",border:"2px solid var(--accent)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:(0,a.jsx)(I.A,{size:20,style:{color:"var(--accent)"}})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{style:{fontFamily:"var(--font-syne)",fontSize:"1rem",fontWeight:700,color:"var(--text-primary)",letterSpacing:"-0.02em",margin:0,lineHeight:1.2},children:"Saudi Solar Estimator"}),(0,a.jsx)("p",{className:"hidden sm:block",style:{fontFamily:"var(--font-newsreader)",fontStyle:"italic",fontSize:"0.75rem",color:"var(--text-secondary)",margin:0},children:"Free solar analysis with PVGIS data & SEC tariffs"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"hidden md:inline-flex items-center px-2.5 py-1 rounded-full text-xs",style:{fontFamily:"var(--font-syne)",fontWeight:500,backgroundColor:"var(--info-soft)",color:"var(--info)"},children:"PVGIS (JRC)"}),(0,a.jsx)("span",{className:"hidden md:inline-flex items-center px-2.5 py-1 rounded-full text-xs",style:{fontFamily:"var(--font-syne)",fontWeight:500,backgroundColor:"var(--success-soft)",color:"var(--success)"},children:"SEC Tariff"}),(0,a.jsx)(ew,{})]})]})}),(0,a.jsx)("main",{className:"max-w-7xl mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,a.jsxs)("div",{className:"lg:col-span-1 animate-slideInLeft",children:[(0,a.jsx)(T,{estimator:e}),(0,a.jsxs)("div",{className:"lg:hidden mt-8",children:[r&&(0,a.jsx)(eS,{}),o&&(0,a.jsx)(eM,{error:o}),t&&!r&&(0,a.jsx)(eF,{estimator:e}),!t&&!r&&!o&&(0,a.jsx)(eA,{})]})]}),(0,a.jsxs)("div",{className:"hidden lg:block lg:col-span-2",children:[r&&(0,a.jsx)(eS,{}),o&&(0,a.jsx)(eM,{error:o}),t&&!r&&(0,a.jsx)(eF,{estimator:e}),!t&&!r&&!o&&(0,a.jsx)(eA,{})]})]})}),(0,a.jsx)("footer",{className:"mt-12 geo-border",style:{backgroundColor:"var(--bg-secondary)",borderTop:"1px solid var(--border)"},children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{style:{width:2,minHeight:48,backgroundColor:"var(--accent)",borderRadius:1,flexShrink:0,opacity:.6}}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("p",{className:"text-xs",style:{fontFamily:"var(--font-newsreader)",color:"var(--text-secondary)"},children:["Solar irradiance data from"," ",(0,a.jsx)("a",{href:"https://re.jrc.ec.europa.eu/pvgis5",style:{color:"var(--accent)"},className:"hover:underline",target:"_blank",rel:"noopener noreferrer",children:"PVGIS v5.3 (Joint Research Centre, European Commission)"}),". Electricity tariff from"," ",(0,a.jsx)("a",{href:"https://www.se.com.sa/en-us/customers/pages/tariff.aspx",style:{color:"var(--accent)"},className:"hover:underline",target:"_blank",rel:"noopener noreferrer",children:"Saudi Electricity Company (SEC)"}),". Self-consumption range from Fraunhofer ISE."]}),(0,a.jsx)("p",{className:"text-xs",style:{fontFamily:"var(--font-newsreader)",fontStyle:"italic",color:"var(--text-tertiary)"},children:"Estimates only — not financial advice. Verify with a qualified solar installer before investing. Export credit rate is never assumed by this tool."})]})]})})})]})}function eM(e){let{error:t}=e;return(0,a.jsx)("div",{className:"animate-fadeUp",style:{borderRadius:"var(--radius-lg)",backgroundColor:"var(--danger-soft)",border:"1px solid var(--danger)",padding:"20px"},children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)(eC.A,{size:20,style:{color:"var(--danger)",flexShrink:0,marginTop:2}}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{style:{fontFamily:"var(--font-syne)",fontWeight:600,fontSize:"0.9rem",color:"var(--text-primary)",margin:"0 0 4px"},children:"Could not fetch solar data"}),(0,a.jsx)("p",{style:{fontFamily:"var(--font-newsreader)",fontSize:"0.85rem",color:"var(--text-secondary)",margin:"0 0 8px"},children:t}),(0,a.jsx)("p",{style:{fontFamily:"var(--font-newsreader)",fontStyle:"italic",fontSize:"0.75rem",color:"var(--text-tertiary)",margin:0},children:"PVGIS (the European Commission solar database) may be temporarily unavailable. Please try again in a few minutes. Your inputs are preserved."})]})]})})}function eF(e){let{estimator:t}=e,{result:r,inputs:n}=t;return r?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"animate-fadeUp",children:(0,a.jsx)(O,{result:r})}),r.citizenComparisons&&(0,a.jsx)("div",{className:"animate-fadeUp-delay-1",children:(0,a.jsx)(eh,{comparisons:r.citizenComparisons})}),r.economics&&(0,a.jsx)("div",{className:"animate-fadeUp-delay-2",children:(0,a.jsx)(em,{economics:r.economics})}),(0,a.jsx)("div",{className:"animate-fadeUp-delay-3",children:(0,a.jsx)(el,{data:r.monthlyBreakdown})}),(0,a.jsxs)("div",{className:"animate-fadeUp-delay-4 grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsx)(ed,{usableAreaM2:n.roof.usableAreaM2,systemKwp:r.sizing.systemKwp,roofCoverage:r.sizing.roofCoverage,panelCount:r.sizing.panelCount}),(0,a.jsx)(ec,{estimator:t})]}),(0,a.jsx)("div",{className:"animate-fadeUp-delay-5",children:(0,a.jsx)(eg,{result:r,inputs:n})})]}):null}function eA(){return(0,a.jsxs)("div",{className:"gradient-mesh noise-overlay animate-fadeIn",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:320,borderRadius:"var(--radius-xl)",border:"1px solid var(--border)",textAlign:"center",padding:"48px 32px",position:"relative",overflow:"hidden"},children:[(0,a.jsx)("svg",{width:"200",height:"200",viewBox:"0 0 200 200",style:{position:"absolute",opacity:.04,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:(0,a.jsx)("polygon",{points:"100,10 120,80 195,80 135,120 155,195 100,150 45,195 65,120 5,80 80,80",fill:"currentColor"})}),(0,a.jsx)("div",{className:"animate-accentPulse",style:{width:64,height:64,borderRadius:"50%",border:"2px solid var(--accent)",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:20,position:"relative",zIndex:1},children:(0,a.jsx)(I.A,{size:32,style:{color:"var(--accent)"}})}),(0,a.jsx)("p",{style:{fontFamily:"var(--font-syne)",fontWeight:600,fontSize:"1.1rem",color:"var(--text-primary)",margin:"0 0 8px",position:"relative",zIndex:1},children:"Your results will appear here"}),(0,a.jsx)("p",{style:{fontFamily:"var(--font-newsreader)",fontStyle:"italic",fontSize:"0.9rem",color:"var(--text-secondary)",margin:0,maxWidth:320,position:"relative",zIndex:1},children:"Complete the 4-step wizard and click “Calculate My Solar Savings”"})]})}}},e=>{e.O(0,[200,441,255,358],()=>e(e.s=2234)),_N_E=e.O()}]);